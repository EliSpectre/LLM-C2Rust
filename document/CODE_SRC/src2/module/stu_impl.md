# stu 文件文档

```markdown
# 文件概述  
stu.c 是学生信息管理系统的核心实现文件，主要负责学生数据的文件操作、读取、显示及查询功能。该文件通过读取预定义的文件（路径由 `FILENAME` 宏指定）解析学生信息，并提供按成绩范围筛选学生数据的功能。核心功能包括：  
1. 初始化文件操作  
2. 读取学生数据  
3. 显示所有学生信息  
4. 根据成绩范围查询学生信息  

---

## 函数说明  

### 1. `void init()`  
**功能**：初始化文件操作，确保文件存在并可读写。  
**参数**：无  
**返回值**：无  
**实现细节**：  
- 尝试以 `rb+` 模式打开文件，若失败则尝试以 `wb+` 模式创建新文件  
- 输出文件大小信息  
**注意事项**：  
- 依赖 `config.h` 中定义的 `FILENAME` 宏  
- 若文件打开失败，程序直接终止  

---

### 2. `void pause(const char *message)`  
**功能**：显示提示信息并暂停程序，等待用户输入任意键继续。  
**参数**：  
- `message`：要显示的提示信息字符串  
**返回值**：无  
**实现细节**：  
- 调用 `getchar()` 等待用户输入  
**注意事项**：  
- 会清除输入缓冲区中的残留字符（如未处理的换行符）  

---

### 3. `int readStudentData(STU students[], int max_students)`  
**功能**：从文件中读取学生数据并存储到数组中。  
**参数**：  
- `students`：存储学生数据的目标数组  
- `max_students`：数组最大容量  
**返回值**：成功读取的学生数量，失败返回 `0`  
**实现细节**：  
1. 跳过文件首行（表头）  
2. 按逗号分隔符解析每行数据，格式为：`ID,Name,Sex,Age,Math,Chinese,English`  
3. 使用 `sscanf` 解析字段，若解析失败则输出错误信息  
**注意事项**：  
- 文件必须以文本模式打开（`"r"` 模式）  
- 每个字段长度需符合预定义限制（如 `name` 最长63字符，`sex` 最长9字符）  
- 若文件为空或格式错误，返回 `0`  

---

### 4. `void showAllStu()`  
**功能**：显示所有学生信息。  
**参数**：无  
**返回值**：无  
**实现细节**：  
1. 调用 `readStudentData` 读取数据  
2. 打印表头和分隔线  
3. 逐行输出学生信息（格式：`ID	Name	Sex	Age	Math	Chinese	English`）  
**注意事项**：  
- 最大支持显示100名学生（由局部数组 `students[100]` 决定）  
- 若无数据，提示用户并暂停  

---

### 5. `void findStuByScores()`  
**功能**：根据数学成绩范围筛选并显示学生信息。  
**参数**：无  
**返回值**：无  
**实现细节**：  
1. 提示用户输入最小/最大成绩值  
2. 调用 `readStudentData` 读取数据  
3. 遍历学生数据，筛选满足 `min_score ≤ Math ≤ max_score` 的记录  
4. 若无匹配结果，提示用户并暂停  
**注意事项**：  
- 仅比较数学成绩（`Math` 字段），其他科目未参与筛选  
- 用户输入需为浮点数值，否则可能导致未定义行为  

---

## 数据结构  
本文件未直接定义结构体或枚举，但依赖以下外部定义：  
- **`STU` 结构体**：定义在 `stu.h` 中，包含以下字段：  
  ```c  
  typedef struct {
      int id;
      char name[64];   // 姓名（最大63字符）
      char sex[10];    // 性别（最大9字符）
      int age;
      float math;      // 数学成绩
      float cn;        // 语文成绩
      float en;        // 英语成绩
  } STU;
  ```  

---

## 使用示例  
```c  
#include "stu.h"

int main() {
    init();  // 初始化文件操作

    // 显示所有学生信息
    showAllStu();

    // 查询数学成绩在80到90之间的学生
    findStuByScores();

    return 0;
}
```  

---

## 依赖关系  
### 依赖的外部文件：  
1. `config.h`：定义 `FILENAME` 宏（文件路径）  
2. `stu.h`：定义 `STU` 结构体及接口函数声明  
3. `tools.h`：可能包含 `getFileSize` 等工具函数  
4. `vars.h`：定义全局变量（如未在代码中体现，需根据实际项目补充）  

### 被依赖关系：  
- 该文件的函数（如 `readStudentData`）可能被其他模块（如主程序或 GUI 界面）调用  
- 需确保 `FILENAME` 指向的文件存在且格式正确  
```

---
*此文档由 CFileDocGenerator 自动生成 - 2025-04-07 20:00*