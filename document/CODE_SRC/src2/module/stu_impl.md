# stu 文件文档

```markdown
# 文件概述
`stu.c` 是学生信息管理系统的实现文件，主要负责学生数据的读取、展示及查询功能。该文件通过文件操作实现学生信息的持久化存储，并提供界面交互功能。核心功能包括：初始化文件操作、读取学生数据、显示所有学生信息、根据成绩范围查询学生。

---

## 函数说明

### 1. `void init()`
**功能**：初始化文件操作，确保数据文件存在并可读写。  
**参数**：无  
**返回值**：无  
**注意事项**：  
- 尝试以 `rb+` 模式打开文件，若失败则以 `wb+` 模式创建新文件。  
- 若文件完全不可用，程序会打印错误信息后退出。  
- 调用 `getFileSize` 函数（来自 `tools.h`）获取文件大小。  

---

### 2. `void pause(const char *message)`
**功能**：显示提示信息并等待用户按键继续。  
**参数**：  
- `message`：要显示的提示信息字符串。  
**返回值**：无  
**注意事项**：  
- 使用 `getchar()` 等待输入，但未处理输入缓冲区残留问题（如换行符）。  

---

### 3. `int readStudentData(STU students[], int max_students)`
**功能**：从文件中读取学生数据并存储到数组。  
**参数**：  
- `students`：存储学生数据的目标数组。  
- `max_students`：数组的最大容量。  
**返回值**：实际读取的学生数量。  
**注意事项**：  
- 跳过文件第一行表头。  
- 使用 `sscanf` 解析每行数据，要求字段严格符合 `id,name,sex,age,math,chinese,english` 格式。  
- 若某行解析失败，会打印错误信息但继续处理后续行。  

---

### 4. `void showAllStu()`
**功能**：显示所有学生信息。  
**参数**：无  
**返回值**：无  
**注意事项**：  
- 内部调用 `readStudentData` 读取数据，假设最大学生数为 100。  
- 若无学生数据，显示提示信息并等待用户按键。  

---

### 5. `void findStuByScores()`
**功能**：根据数学成绩范围查询学生信息。  
**参数**：无  
**返回值**：无  
**注意事项**：  
- 用户需手动输入成绩范围（`min_score` 和 `max_score`）。  
- 仅查询数学成绩在指定范围内的学生。  
- 若无匹配结果，显示错误信息并等待用户按键。  

---

## 数据结构
依赖 `stu.h` 中定义的 `STU` 结构体（未在当前文件中定义），其典型定义可能如下：
```c
typedef struct {
    int id;
    char name[64]; // 姓名（最大63字符）
    char sex[10];  // 性别（如"Male"/"Female"）
    int age;
    float math;    // 数学成绩
    float cn;      // 语文成绩
    float en;      // 英语成绩
} STU;
```

---

## 使用示例
### 示例 1：初始化并显示学生信息
```c
#include "stu.h"

int main() {
    init();         // 初始化文件
    showAllStu();   // 显示所有学生
    return 0;
}
```

### 示例 2：查询数学成绩在 80~90 分之间的学生
```c
#include "stu.h"

int main() {
    init();
    findStuByScores(); // 用户输入后触发查询
    return 0;
}
```

---

## 依赖关系
### 依赖项
1. **头文件**：  
   - `<stdio.h>`：文件操作函数（如 `fopen`, `fgets`）。  
   - `<stdlib.h>`：内存管理和 `exit` 函数。  
   - `<string.h>`：字符串处理（如 `strcpy`）。  
   - `config.h`：定义常量（如 `FILENAME`）。  
   - `stu.h`：定义 `STU` 结构体。  
   - `tools.h`：提供 `getFileSize` 等工具函数。  
   - `vars.h`：可能包含全局变量（如配置参数）。  

### 被依赖项
- 该文件的函数（如 `readStudentData`）可能被其他模块调用（如主程序或 UI 模块）。  
- `init` 函数通常应在程序启动时被调用以确保文件可用性。  
```

---
*此文档由 CFileDocGenerator 自动生成 - 2025-04-04 21:41*